<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Citi Shop Your Way - Offer Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Citi Shop Your Way - Offer Tracker</h1>
            <div class="person-selector">
                <label for="person-select">Card Holder:</label>
                <select id="person-select">
                    <option value="">Loading...</option>
                </select>
                <button id="manage-people-btn" class="small-btn">Manage</button>
            </div>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
            <button class="tab-btn" data-tab="recommendations">Recommendations</button>
            <button class="tab-btn" data-tab="transactions">Transactions</button>
            <button class="tab-btn" data-tab="offers">Offers</button>
        </nav>

        <!-- Database Setup Modal -->
        <!-- Database setup modal removed - PostgreSQL version auto-connects -->

        <!-- People Management Modal -->
        <div id="people-modal" class="modal">
            <div class="modal-content">
                <h2>Manage Card Holders</h2>
                <div id="people-list"></div>
                <div class="form-group">
                    <input type="text" id="new-person-name" placeholder="New cardholder name">
                    <button id="add-person-btn">Add</button>
                </div>
                <div class="form-buttons">
                    <button type="button" id="close-people-modal">Close</button>
                </div>
            </div>
        </div>

        <!-- Transaction Edit Modal -->
        <div id="transaction-edit-modal" class="modal">
            <div class="modal-content">
                <h2>Edit Transaction</h2>
                <form id="transaction-edit-form">
                    <div class="form-group">
                        <label for="edit-transaction-date">Date:</label>
                        <input type="date" id="edit-transaction-date" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-transaction-amount">Amount ($):</label>
                        <input type="number" id="edit-transaction-amount" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-transaction-merchant">Merchant:</label>
                        <div class="autocomplete-container">
                            <input type="text" id="edit-transaction-merchant" required autocomplete="off">
                            <div id="edit-merchant-suggestions" class="autocomplete-suggestions"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Categories:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="edit-transaction-category" value="general"> General</label>
                            <label><input type="checkbox" name="edit-transaction-category" value="online"> Online</label>
                            <label><input type="checkbox" name="edit-transaction-category" value="grocery"> Grocery</label>
                            <label><input type="checkbox" name="edit-transaction-category" value="gas"> Gas</label>
                            <label><input type="checkbox" name="edit-transaction-category" value="restaurant"> Restaurant</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="edit-transaction-description">Description (optional):</label>
                        <input type="text" id="edit-transaction-description">
                    </div>
                    <div class="form-group">
                        <label>Matching Offers:</label>
                        <div id="edit-matching-offers" class="matching-offers"></div>
                    </div>
                    <div class="form-buttons">
                        <button type="submit">Update Transaction</button>
                        <button type="button" id="cancel-edit-transaction">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <main>
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <h2>Ultra High Priority Opportunities</h2>
                <div id="ultra-high-recommendations"></div>

                <h2>Offer Progress</h2>
                <div id="offer-progress"></div>
            </div>

            <!-- Recommendations Tab -->
            <div id="recommendations" class="tab-content">
                <h2>Spending Recommendations</h2>
                <div id="all-recommendations"></div>
            </div>

            <!-- Transactions Tab -->
            <div id="transactions" class="tab-content">
                <h2>Add Transaction</h2>
                <form id="transaction-form">
                    <div class="form-group">
                        <label for="transaction-date">Date:</label>
                        <input type="date" id="transaction-date" required>
                    </div>
                    <div class="form-group">
                        <label for="transaction-amount">Amount ($):</label>
                        <input type="number" id="transaction-amount" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="transaction-merchant">Merchant:</label>
                        <div class="autocomplete-container">
                            <input type="text" id="transaction-merchant" required autocomplete="off">
                            <div id="merchant-suggestions" class="autocomplete-suggestions"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Categories:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="transaction-category" value="general"> General</label>
                            <label><input type="checkbox" name="transaction-category" value="online"> Online</label>
                            <label><input type="checkbox" name="transaction-category" value="grocery"> Grocery</label>
                            <label><input type="checkbox" name="transaction-category" value="gas"> Gas</label>
                            <label><input type="checkbox" name="transaction-category" value="restaurant"> Restaurant</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="transaction-description">Description (optional):</label>
                        <input type="text" id="transaction-description">
                    </div>
                    <button type="submit">Add Transaction</button>
                </form>

                <h3>Recent Transactions</h3>
                <div id="transaction-list"></div>
            </div>

            <!-- Offers Tab -->
            <div id="offers" class="tab-content">
                <h2>Manage Offers</h2>
                <button id="add-offer-btn" class="btn-primary">Add New Offer</button>

                <div id="offer-form-container" class="hidden">
                    <h3>Add/Edit Offer</h3>
                    <form id="offer-form">
                        <div class="form-group">
                            <label for="offer-name">Offer Name:</label>
                            <input type="text" id="offer-name" required>
                        </div>
                        <div class="form-group">
                            <label for="offer-type">Offer Type:</label>
                            <select id="offer-type" required>
                                <option value="">Select Type</option>
                                <option value="spending">Spending Amount</option>
                                <option value="transactions">Number of Transactions</option>
                                <option value="combo">Combination</option>
                            </select>
                        </div>
                        <div class="form-group date-row">
                            <div class="date-input">
                                <label for="offer-start-date">Start Date:</label>
                                <input type="date" id="offer-start-date" required>
                            </div>
                            <div class="date-input">
                                <label for="offer-end-date">End Date:</label>
                                <input type="date" id="offer-end-date" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="offer-monthly-tracking"> Monthly Tracking (track progress month by month)
                            </label>
                        </div>
                        <div class="form-group">
                            <label for="offer-spending-target">Spending Target ($):</label>
                            <input type="number" id="offer-spending-target" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="offer-transaction-target">Transaction Count Target:</label>
                            <input type="number" id="offer-transaction-target" min="0">
                        </div>
                        <div class="form-group">
                            <label for="offer-min-transaction">Minimum Transaction Amount ($):</label>
                            <input type="number" id="offer-min-transaction" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label>Required Categories:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="offer-category" value="general"> General</label>
                                <label><input type="checkbox" name="offer-category" value="online"> Online</label>
                                <label><input type="checkbox" name="offer-category" value="grocery"> Grocery</label>
                                <label><input type="checkbox" name="offer-category" value="gas"> Gas</label>
                                <label><input type="checkbox" name="offer-category" value="restaurant"> Restaurant</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="offer-reward">Reward Amount ($):</label>
                            <input type="number" id="offer-reward" step="0.01" min="0">
                            <small style="color: #666; display: block; margin-top: 0.25rem;">Base reward (optional if using tiers below)</small>
                        </div>
                        <div class="form-group">
                            <label for="offer-bonus-reward">Bonus Reward ($) (if applicable):</label>
                            <input type="number" id="offer-bonus-reward" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="offer-tiers">Tiered Rewards (optional):</label>
                            <textarea id="offer-tiers" rows="3" placeholder="Enter tiers like: 750:125&#10;1500:200&#10;(threshold:reward, one per line)"></textarea>
                            <small style="color: #666; display: block; margin-top: 0.25rem;">For multi-tier offers: Enter "spending:reward" per line (e.g., "750:125" then "1500:200")</small>
                        </div>
                        <div class="form-group">
                            <label for="offer-description">Description:</label>
                            <textarea id="offer-description" rows="3"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button type="submit">Save Offer</button>
                            <button type="button" id="cancel-offer">Cancel</button>
                        </div>
                    </form>
                </div>

                <h3>Current Offers</h3>
                <div id="offer-list"></div>
            </div>
        </main>
    </div>

    <script src="database.js"></script>
    <script src="data-manager.js"></script>
    <script src="app.js"></script>
</body>
</html>